<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8" />
    <title>Word guess Game</title>
    <link rel="stylesheet" type="text/css" href="reset.css" />
    <link rel="stylesheet" type="text/css" href="Style.css" />
  </head>

  <body>
    <main>
      <div class="game">
        <h3>Remaining Guesses</h3>
        <h1 id="remainingMoves">6</h1>

        <h2 id="anounce">Press Space to start</h2>

        <section id="activeBoard">
          <span id="0"></span>
          <span id="1"></span>
          <span id="2"></span>
          <span id="3"></span>
          <span id="4"></span>
          <span id="5"></span>
          <span id="6"></span>
        </section>
        <section id="usedLetters">
          Nothing guessed yet
        </section>
        <div id="scoreboard">
          <div id="wins">
            <h3>Wins</h3>
            <h1 id="winCount">0</h1>
          </div>
          <div id="losses">
            <h3>Losses</h3>
            <h1 id="lossCount">0</h1>
          </div>
        </div>
      </div>
    </main>
    <script>
      var gameStarted = false;
      var wins = 0;
      var losses = 0;
      var words = ["test", "word", "three", "four", "five", "six", "seven"];
      var currentWord = "start";
      var correctCount = 0;
      var usedLetters = [];
      var guessesRemaining = 6;
      var correctGuess = false;

      document.onkeyup = function(event) {
        var letter = event.key.toLowerCase();
        correctGuess = false;

        if (gameStarted) {
          //check if letter has been guessed before anounce if it has
          if (usedLetters.includes(letter)) {
            var anounce = document.getElementById("anounce");
            anounce.innerText = "You already guessed that";
          } else {
            //add letter pressed to used letter array
            usedLetters.push(letter);
            var usedSection = document.getElementById("usedLetters");
            usedSection.innerText = usedLetters;

            //check if letter typed is in word and replace underscore if correct
            for (let i = 0; i < currentWord.length; i++) {
              console.log(currentWord);
              if (letter === currentWord.charAt(i)) {
                var activeLetter = document.getElementById(i);
                activeLetter.innerText = currentWord.charAt(i) + " ";
                correctCount++;
                correctGuess = true;
                var anounce = document.getElementById("anounce");
                anounce.innerText = "Nice guess";

                //win state
                if (correctCount === currentWord.length) {
                  console.log("you win");
                  correctCount = 0;
                  gameStarted = false;
                  wins++;
                  guessesRemaining = 6;
                  usedLetters.length = 0;
                  var usedSection = document.getElementById("usedLetters");
                  usedSection.innerText = "Nothing guessed yet";
                  var anounce = document.getElementById("anounce");
                  anounce.innerText = "Press Space to play again";
                  var anounce = document.getElementById("winCount");
                  anounce.innerText = wins;
                  var anounce = document.getElementById("remainingMoves");
                  anounce.innerText = guessesRemaining;
                }
              }
            }
            //incorrect guesses decrement guesses
            if (!correctGuess) {
              guessesRemaining--;
              var anounce = document.getElementById("remainingMoves");
              anounce.innerText = guessesRemaining;
              console.log(guessesRemaining);
              var anounce = document.getElementById("anounce");
              anounce.innerText = "Incorrect";

              //lose state
              if (guessesRemaining === 0) {
                losses++;
                var usedSection = document.getElementById("usedLetters");
                usedSection.innerText = "Nothing guessed yet";
                var anounce = document.getElementById("anounce");
                anounce.innerText = "You lost, press space to play again";
                var anounce = document.getElementById("lossCount");
                anounce.innerText = losses;
                gameStarted = false;
                usedLetters.length = 0;
                guessesRemaining = 6;
                var anounce = document.getElementById("remainingMoves");
                anounce.innerText = guessesRemaining;
              }
            }
          }
          //checks if space is pressed to start the game
        } else if (event.keyCode === 32) {
          // sets the game active, picks a word from the list, and sets the board empty
          var anounce = document.getElementById("anounce");
          anounce.innerText = "Press a letter to guess";
          gameStarted = true;
          var wordSelectionNumber = Math.floor(Math.random() * words.length);
          currentWord = words[wordSelectionNumber];

          //creates board based on length of picked word
          for (let i = 0; i < 7; i++) {
            if (i < currentWord.length) {
              var elem = document.getElementById(i);
              elem.innerText = "_ ";
            } else {
              var elem = document.getElementById(i);
              elem.innerText = " ";
            }
          }
        }
      };
    </script>
  </body>
</html>
